---
title: "从头再来之单变量微积分"
date: 2021-07-11T15:01:38+08:00
draft: false
categories:
    - work
    - mathematics
    - calculus
    - machine learning
tags:
    - math
    - calculus
    - 从头再来
libraries:
    - katex

enableTocContent: true
---

## 前沿

MIT 18.01，该学的总得学 （该复习的总得复习）

微积分基本忘得差不多了，所以开始复习

总得来说18.01应该是面向的刚入学的大一学生，而且他们高中好像没有学过微积分，所以听起来挺简单的，快速过一下

但是因为简单，所以弹幕氛围不是很好。老师讲课还是很不错的

而且发现MIT很大的特点都是举非常多非常多的例子来练习，然后对于一些工科不那么重要的证明就偏向于理解型的去证明

而且常听常新

笔记中很大程度上借鉴了知乎@三少爷的键，感谢大佬


## 1. 导数 (derivative)

### 几何解释

![图片1.png](https://i.loli.net/2021/07/11/p4kCTMmu6IYP7QN.png)

求图像 $y=f(x)$ 在某点 $P=(x_{0},y_{0})$ 处的切线：$y-y_{0}=m(x-x_{0})$。因此我们需要一下几个条件：

1. 这个切线经过点$p=(x_{0},y_{0})$，所以有： $y_{o}=f(x_{0})$

2. 这个切线的斜率：$m$，即 $f$ 的导数 $f'(x)$

所以这里就可以给出导数的定义：

**导数(derivative)**：它是$f$在$x_{0}$处的导数，也是$y=f(x)$在此点的斜率

-------------------------------------------

![图片2.png](https://i.loli.net/2021/07/11/VQ4MUb2Wo3DLaHt.png)

也可以这样理解，另取一个点$Q$与$P$构成一条割线，当$Q$逐渐逼近$P$时，割线就会逐渐逼近切线，即：

**切线其实是一种极限**，是$Q$趋近于$P$时，割线$PQ$的极限（可以把$P$当做不变，而$Q$变化）

- 水平方向上的位置差$\Delta x$，即$x$的变化量
- 斜率所对应增长的高即$\Delta f$

所以，割线的斜率表示为:$\frac{\Delta f}{\Delta x}$

而割线逼近切斜的过程可以用$\Delta x \rightarrow 0$，即$\Delta x$趋近于0的极限来表示

所以切线的斜率是：

$$m=\lim_{\Delta x \rightarrow 0}{\frac{\Delta f}{\Delta x}}$$

所以，**导数的含义还可以理解为**：

导数等于当$\Delta x$趋近于0时，$f$的变化量，即

$$f'(x_{0}) = \lim_{\Delta x_{0}\rightarrow 0}{\frac{f(x_{0}+\Delta x)-f(x_{0})}{\Delta x}}$$

-------------------------------------------

举几个例子：

- $f(x) = \frac{1}{x}$

$$\frac{\Delta f}{\Delta x}=\frac{\frac{1}{x_{0}+\Delta x}-\frac{1}{x_{0}}}{\Delta x}=\frac{1}{\Delta x}\left[\frac{x_{0}-\left(x_{0}+\Delta x\right)}{\left(x_{0}+\Delta x\right) x_{0}}\right]=\frac{1}{\Delta x}\left[\frac{-\Delta x}{\left(x_{0}+\Delta x\right) x_{0}}\right]=\frac{-1}{\left(x_{0}+\Delta x\right) x_{0}}$$

> 这个表达$\frac{\Delta f}{\Delta x}$有一个学名，叫做**差商(difference quotient)**

现在取$\Delta x\rightarrow 0$，得到最终的导数：

$$\lim_{\Delta x \rightarrow 0} \frac{-1}{\left(x_{0}+\Delta x\right) x_{0}}=-\frac{1}{x_{0}^{2}}$$

![图片3.png](https://i.loli.net/2021/07/11/hBfjuMaAvqX9YiS.png)

> 可以简单检验一下结果的正确：1.切线的斜率永远都是负的，即导数永远都是负的 2.当$\Delta x \rightarrow \infty$，$f^{\prime}\left(x_{0}\right)$的绝对值越来越小，对应图像上的切线越来越平缓

**另一个例子：**（导数的实际应用）

求由$y=1/x$切线和坐标轴围合而成的三角形区域面积，即上图中的阴影部分面积

通过$P=(x_{0},y_{0})$点的切线方程：

$$y-y_{0}=f^{\prime}\left(x_{0}\right)\left(x-x_{0}\right)=\frac{-1}{x_{0}^{2}}\left(x-x_{0}\right)$$

- 计算$x$轴截距，当$y=0$时，$x=2x_{0}$
- 计算$y$轴截距，因为$y=1/x$是对称的，所以$y=2y_{0}$

最后可得三角形面积：$\left(2 x_{0}\right)\left(2 y_{0}\right) / 2=\left(2 x_{0}\right)\left(2 / x_{0}\right) / 2=2$

**再举一个例子**

$f(x)=x^{n}$，$n=1,2,\cdots$，求$f'$


$$\frac{\Delta f}{\Delta x}=\frac{(x+\Delta x)^{n}-x^{n}}{\Delta x}$$

二项式定理：

$$(x+\Delta x)^{n}=(x+\Delta x)(x+\Delta x) \cdots(x+\Delta x)=x^{n}+n x^{n-1} \Delta x+O\left((\Delta x)^{2}\right)$$

> 其中，$O\left((\Delta x)^{2}\right)$表示这些项中$\Delta x$具有更高阶，在求$x^{n}$导数的这个问题中可以忽略不计

所以，可以得到：

$$ \begin{aligned} \frac{\Delta f}{\Delta x} &=\frac{1}{\Delta x}\left((x+\Delta x)^{n}-x^{n}\right) \\\\\\\\ &=\frac{1}{\Delta x}\left(x^{n}+n x^{n-1} \Delta x+O\left((\Delta x)^{2}\right)-x^{n}\right) \\\\\\\\ &=n x^{n-1}+O(\Delta x) \end{aligned} $$

当$\Delta x\rightarrow 0$时，可以得到：

$$\frac{d}{d x} x^{n}=n x^{n-1}$$

### 导数的表示法

- 牛顿：$f'$
- 莱布尼茨：$\frac{d f}{d x}=\frac{d y}{d x}=\frac{d}{d x} f=\frac{d}{d x} y$

$$f' = \frac{d f}{d x}=\frac{d y}{d x}=\frac{d}{d x} f=\frac{d}{d x} y$$

> 经常的情况，混在一块用也是可以的

### 物理解释

> 导数即“变化率”

![图片4.png](https://i.loli.net/2021/07/12/5zDsPdR4IkbXKvy.png)

当作图$y=f(x)$时，我们可以记录$x$和$y$的变化，就相当于记录了相对变换率：$\frac{\Delta y}{\Delta x}$

从变化率的角度，这是一种平均变化率（通常可以把$x$想象成时间）

$\Delta x \rightarrow 0$则有：$\frac{\Delta y}{\Delta x} \rightarrow \frac{d y}{d x}$，变成了瞬时变化率

**举几个例子：**

1. $q$表示电荷，$\frac{d q}{d t}$表示电流
2. $s$表示距离，$\frac{d s}{d t}$表示速度
3. $T$表示温度，$\frac{d T}{d t}$表示温度梯度


## 2. 极限和连续 (limits and continuity)

### 极限

举一些简单极限的例子：$\lim _{x \rightarrow 4} \frac{x+3}{x^{2}+1}=\frac{4+3}{4^{2}+1}=\frac{7}{17}$

但是导数的情况永远不会那么简单：$\lim_{x \rightarrow x_{0}} \frac{f(x)-f\left(x_{0}\right)}{x-x_{0}}$，结果永远是$0/0$，所以需要先对他进行一些消运算

- **右极限**：$\lim_{x \rightarrow x_{0}^{+}} f(x)$，表示取的是函数的右极限。即$x$从$x_{0}$的右侧接近$x_{0}$
    $x\rightarrow x_{0}$
    $x>x_{0}$

- **左极限**：$\lim_{x \rightarrow x_{0}^{-}} f(x)$，表示取的是函数的左极限。即$x$从$x_{0}$的左侧接近$x_{0}$
    $x\rightarrow x_{0}$
    $x<x_{0}$

</br>

举个例子：$f(x)=\left\\{\begin{array}{c}x+1, x \geq 0 \\\\ -x+2, x<0\end{array}\right.$

![图片5.png](https://i.loli.net/2021/07/12/NzAHBSneavrsOt3.png)
> 图源知乎@三少爷的键

右极限： $\lim_{x \rightarrow 0^{+}} f(x)=\lim _{x \rightarrow 0} x+1=1$

左极限： $\lim_{x \rightarrow 0^{-}} f(x)=\lim _{x \rightarrow 0}-x+2=2$

> 求极限的时候不需要知道$x=0$的函数值，比如这里根本就没定义过$f(0)$

### 连续

**定义**：$x\rightarrow x_{0}$时，$f(x)$的极限等于$f(x_{0})$，则称：$f$在$x_{0}$点的连续。即：

1. 要求$\lim_{x \rightarrow x_{0}} f(x)$这一极限必须存在，**左极限=右极限**
2. $f(x_{0})$必须有定义
3. 函数值和极限相等：$\lim_{x \rightarrow x_{0}} f(x)=f\left(x_{0}\right)$

------------------------

讨论几种不连续的情况：

1. 跳跃间断：左右极限均存在，但是不相等。即上面的这个例子就是跳跃间断

2. 可去间断：左右极限存在并相等，但不等于函数值。

    ![图片6.png](https://i.loli.net/2021/07/13/AwDmlRu9Qzcxfq2.png)
    > 图源知乎@三少爷的键

    例：$g(x)=\frac{\sin x}{x}$ 和 $h(x)=\frac{1-\cos x}{x}$ 他们在零点无定义，但是他们可以在零点去极限，所以他们在$x=0$可去间断

3. 无穷间断：左右极限是无穷
    
    例：$y=1/x$

    $\lim_{x\rightarrow x^{+}}\frac{1}{x} = \infty$

    $\lim_{x\rightarrow x^{-}}\frac{1}{x} = -\infty$

    ![图片7.png](https://i.loli.net/2021/07/13/kXu1n3jzaEYtb8V.png)

    他的导数也是无穷间断，但是是左右极限一致都是负无穷：$y' = \frac{-1}{x^{2}}$

4. 另类（丑陋）间断：例如 $y=\sin{\frac{1}{x}}$，当$x\rightarrow 0$时，将无限震荡，没有左右极限

    ![图片8.png](https://i.loli.net/2021/07/13/iNSLzjnX2GbstZF.png)

------------------------

**定理：可导必连续**，若函数$f(x)$在$x_{0}$点可导，则函数$f(x)$在$x_{0}$连续，即：

$$\lim_{x \rightarrow x_{0}} f(x)-f\left(x_{0}\right)=0$$

证明：

$$\lim_{x \rightarrow x_{0}} f(x)-f\left(x_{0}\right)=\lim_{x \rightarrow x_{0}} \frac{f(x)-f\left(x_{0}\right)}{x-x_{0}}\left(x-x_{0}\right)=f^{\prime}\left(x_{0}\right) \cdot 0=0$$

## 3. 求导公式及三角函数导数

求导公式分为两种：1) 针对特殊函数进行求导； 2) 另一种是通用的求导法则

### 特定的求导法则

1. $x$ 的 $n$ 次方：$f(x) = x^{n}$
   
    $f'(x) = nx^{n-1}$

</br>

2. $x$ 的倒数： $f(x) = \frac{1}{x}$

    $f'(x) = -\frac{1}{x^{2}}$


</br>

3. 正弦函数：$f(x) = \sin{x}$

    $f'(x) = \frac{\mathrm{d}}{\mathrm{d} x} \sin x=\cos x$

    > 简要推导一下：
    >
    > $$ \begin{aligned} \frac{\sin (x+\Delta x)-\sin x}{\Delta x} &=\frac{\sin x \cos \Delta x+\cos x \sin \Delta x-\sin x}{\Delta x} \\\\ &=\sin x\left(\frac{\cos \Delta x-1}{\Delta x}\right)+\cos x\left(\frac{\sin \Delta x}{\Delta x}\right) \end{aligned} $$
    > > 正弦两角和公式：$\sin{(a+b)} = \sin{a}\cos{b} + \cos{a}\sin{b}$
    > > 余弦两角和公式：$\cos{(a+b)} = \cos{a}\cos{b} - \sin{a}\sin{b}$
    > >     
    > > 在进行求解的时候，要尽量把$1/0$化成$0/0$的形式，这样才方便求极限，因此把$\sin x \cos \Delta x$和$\sin x$合并同类项
    > 
    > $\Delta x \rightarrow 0$时，$(\cos \Delta x-1) / \Delta x \rightarrow 0$
    > $\Delta x \rightarrow 0$时，$\sin \Delta x / \Delta x \rightarrow 1$
    > 
    > $$\therefore f'(x) = \frac{\mathrm{d}}{\mathrm{d} x} \sin x=\cos x$$

    > 这里还需要证明一下上面的两个极限：
    > 
    > $$ \begin{aligned} \lim _{\theta \rightarrow 0} \frac{1-\cos \theta}{\theta} &=\lim _{\theta \rightarrow 0}\left(\frac{1-\cos \theta}{\theta} \cdot \frac{1+\cos \theta}{1+\cos \theta}\right) \\\\ &=\lim _{\theta \rightarrow 0} \frac{1-\cos ^{2} \theta}{\theta(1+\cos \theta)} \\\\ &=\lim _{\theta \rightarrow 0} \frac{\sin ^{2} \theta}{\theta(1+\cos \theta)} \\\\ &=\lim _{\theta \rightarrow 0}\left(\frac{\sin \theta}{\theta} \cdot \frac{\sin \theta}{1+\cos \theta}\right) \\\\ &=\left(\lim _{\theta \rightarrow 0} \frac{\sin \theta}{\theta}\right) \cdot\left(\lim _{\theta \rightarrow 0} \frac{\sin \theta}{1+\cos \theta}\right) \\\\ &=1 \cdot \frac{0}{1+1}=0 \end{aligned} $$
    > 
    > $$\lim_{\theta \rightarrow 0} \frac{\sin \theta}{\theta}=1$$
    > 这个证明网上有详细的几何法证明：[正弦函数求导公式基本推导](https://www.cnblogs.com/haogev6/p/8557082.html)，视频中给出的感觉不太严谨

4. 余弦函数：$f(x) = \sin{x}$

    $f'(x) = \frac{\mathrm{d}}{\mathrm{d} x} \cos x=-\sin x$

    > 同上。进行简要推导：
    > 
    > $$ \begin{aligned} \frac{\cos (x+\Delta x)-\cos x}{\Delta x} &=\frac{\cos x \cos \Delta x-\sin x \sin \Delta x-\cos x}{\Delta x} \\\\ &=\cos x\left(\frac{\cos \Delta x-1}{\Delta x}\right)-\sin x\left(\frac{\sin \Delta x}{\Delta x}\right) \end{aligned} $$
    >
    > $$\therefore f'(x) = \frac{\mathrm{d}}{\mathrm{d} x} \cos x=-\sin x$$

### 通用求导法则

1. 导数的加法法则

    $$(u+v)' = u' + v'$$

    或者可以写成：

    $$\frac{\mathrm{d}}{\mathrm{d} x}(u(x)+v(x))=\frac{\mathrm{d}}{\mathrm{d} x} u(x)+\frac{\mathrm{d}}{\mathrm{d} x} v(x)$$

2. 导数的数乘法则

    $$(Cu)' = Cu'$$

    其中，$C$为常数。或写作：

    $$\frac{\mathrm{d}}{\mathrm{d} x} c u(x)=c \frac{\mathrm{d}}{\mathrm{d} x} u(x)$$

3. 导数的乘法法则

    $$(uv)' = u'v + uv'$$

    或者可以写成：

    $$\frac{\mathrm{d}u(x)v(x)}{\mathrm{d} x} =  u(x)\frac{\mathrm{d}v(x)}{\mathrm{d} x}+v(x)\frac{\mathrm{d}u(x)}{\mathrm{d} x}$$

    > 即求导每次只改变一个函数，除法同理

    > 简单证明一下：
    > $$ \begin{aligned} &\Delta(u v)=u(x+\Delta x) v(x+\Delta x)-u(x) v(x) \\\\ &=(u(x+\Delta x)-u(x)) v(x+\Delta x)+u(x)(v(x+\Delta x)-v(x)) \end{aligned} $$
    > 两边取极限，得到：
    > $$\frac{d}{d x}(u v)=\frac{d u}{d x} v+\frac{d v}{d x} u$$

    > 课程中将导数的除法法则单独列出来了，但是我还是习惯将除法化成乘法$X^{-1}$的形式

## 4. 链式法则及高阶导数

### 链式法则

链式法则：一条合乘规则，重点在于代换，即复合函数的微分是两个导数的乘积

$$\frac{\Delta y}{\Delta t}=\frac{\Delta y}{\Delta x} \frac{\Delta x}{\Delta t}$$

举个例子：

$$y=(\sin t)^{10}=\sin ^{10}(t)$$

这种类型的函数，即多个简单函数嵌套在一起，求导方法在于换元，令$x=\sin t$，则有$y=x^{10}$，所以最后得到：

$$\frac{d}{d t}(\sin t)^{10}=10 x^{9} \cos t=10(\sin t)^{9} \cos t$$

再一个例子：

$$\frac{d}{d t} \sin (10 t)$$

$x=10 t$为内函数，$y=\sin x$为外函数

$$\frac{d}{d t} \sin (10 t)=\cos x \cdot 10=10 \cos (10 t)$$

### 高阶导数

高阶导数：指不断的进行求导，要想得到三阶导数，就需要从一阶导数求二阶，从二阶求三阶

$$u=u(x), \quad u^{\prime}, \quad u^{\prime \prime}=\left(u^{\prime}\right)^{\prime}, \quad u^{\prime \prime \prime}=\left(u^{\prime \prime}\right)^{\prime}, \quad u^{(4)}=u^{\prime \prime \prime \prime}=\left(u^{\prime \prime \prime}\right)^{\prime}$$

举个例子：

$$u=\sin x, \quad u^{\prime}=\cos x, \quad u^{\prime \prime}=-\sin x, \quad u^{\prime \prime \prime}=-\cos x, \quad u^{(4)}=\sin x$$

------------------------------------------------

**莱布尼兹表示法**：$u^{\prime}=\frac{d u}{d x}=\frac{d}{d x} u=D u$

可以将$D=\frac{d}{d x}$视为一个运算符，将一个函数转换成另一个函数。比如；输入$\sin$得到他的导数是$\cos$，输入$x^{2}$得到他的导数是$2x$

在这种表示法下，高阶导数可以表示为；

$$u^{\prime \prime}=\frac{d}{d x} \frac{d u}{d x}=\frac{d}{d x} \frac{d}{d x} u=\left(\frac{d}{d x}\right)^{2} u=\frac{d^{2}}{d x^{2}} u=\frac{d^{2} u}{d x^{2}}=D^{2} u$$

表示二阶的导数，注意，这里$\frac{d^{2} u}{d x^{2}}$的分母下的表示法$\mathrm{d} x^{2}$的实际含义是$(\mathrm{d}x)^{2}$

$$u^{\prime \prime \prime}=\frac{d^{3} u}{d x^{3}}=D^{3} u$$

表示三阶代数

举个例子：求$D^{n} x^{n}$

$$ \begin{aligned} D x^{n}&=n x^{n-1} \\\\ D^{2} x^{n}&=n(n-1) x^{n-2} \\\\ D^{3} x^{n}&=n(n-1)(n-2) x^{n-3}\\\\ &\vdots \\\\ D^{n} x^{n}&=n(n-1)(n-2) \ldots 2 \cdot 1=n ! \end{aligned} $$

## 5. 隐函数和逆函数求导

### 隐函数求导

隐函数：两个变量的关系不是显式($y=2x$)，而是隐式的，如：$x^{2}+y^{2}=1$

举个例子，将上面幂的导数扩展为有理数的情况，即：

$$\frac{d}{d x} x^{a}=a x^{a-1}, \quad a=\frac{m}{n}, \quad \text{m,n均为整数，求}\frac{\mathrm{d}y}{\mathrm{d}x}$$

转换一下可得：

$$y^{n}=x^{m}$$

对等式两侧求微分：

$$\frac{d}{d x} y^{n}=\frac{d}{d x} x^{m}$$

> 注意，这里的两边同样都是对$x$求微分

$$ \begin{aligned} &\Rightarrow \frac{d}{d y} y^{n} \frac{d y}{d x}=m x^{m-1} \\\\\\\\ &\Rightarrow n y^{n-1} \frac{d y}{d x}=m x^{m-1} \\\\\\\\ &\Rightarrow \frac{d y}{d x}=\frac{m x^{m-1}}{n y^{n-1}}=\frac{m}{n} \frac{x^{m-1}}{\left(x^{m / n}\right)^{n-1}}=\frac{m}{n} x^{\frac{m}{n}-1}=a x^{a-1} \end{aligned} $$

</br>

再举一个例子：

$$x^{2}+y^{2}=1$$

下面分别用显式的形式与隐式的形式对上式进行求导

显式：

$$y=\left(1-x^{2}\right)^{1 / 2}$$

$$y^{\prime}=\frac{1}{2}\left(1-x^{2}\right)^{-\frac{1}{2}}(-2 x)=\frac{-x}{\sqrt{1-x^{2}}}$$

隐式：等式两边对$x$进行求导：

$$2 x+2 y y^{\prime}=0$$

$$y^{\prime}=-x / y = \frac{-x}{\sqrt{1-x^{2}}}$$

再来一个例子：

$$y^{4}+x y^{2}-2=0$$

等式两边对$x$求导：

$$4 y^{3} y^{\prime}+y^{2}+2 x y y^{\prime}-0=0 \Rightarrow y^{\prime}=\frac{-y^{2}}{4 y^{3}+2 x y}$$

注意，$y^{4}$对$x$求导中其实用到的是链式法则，先$\frac{\mathrm{d}y^{4}}{\mathrm{d}y}\frac{\mathrm{d}y}{\mathrm{x}}$，所以在后面有一个$y'$要跟，这个要记住

### 反函数（逆函数求导）

> 隐函数求导法的一个应用就是求反函数的导数值。只要知道原函数的导数，反函数的导数一定是知道的

举个例子：

$$y=\sqrt{x}, \quad x>0$$

其中，$y$是$x$的原函数：$y=f(x)$，则其反函数$x = g(y) = y^{2}$，也将反函数记为$g=f^{-1}$

![图片9.png](https://i.loli.net/2021/07/14/8FNYc1mnw7dSfGW.png)

从图上看，原函数和反函数是关于$x-y$对称的

举个例子：

$$y=\tan ^{-1} x=\arctan x$$

即

$$\tan (y)=x$$

等式两边对$x$取导数

$$\frac{1}{\cos ^{2} y} y^{\prime}=1$$

$$y^{\prime}=\cos ^{2} y$$

在图像上可以得到：

$$\cos y=\frac{1}{\sqrt{1+x^{2}}}$$

所以可得最终的结果

$$\frac{d}{d x} \tan ^{-1} x=\frac{1}{1+x^{2}}$$

## 6. 指数和对数

### 指数

指数函数：$a^{x}$，表示以$a$为基底的指数函数，遵循如下运算：

$$ \begin{aligned} &a^{x_{1}+x_{2}}&=a^{x_{1}} a^{x_{2}} \\\\ &\left(a^{x_{1}}\right)^{x_{2}}&=a^{x_{1} x_{2}} \end{aligned} $$

其中，指数可以是任意的实数，即：

$a^{m/n} = \sqrt[n]{a^{m}}$

而他的导数是：

$$\frac{\mathrm{d}}{\mathrm{d}x}a^{x} = a^{x}\ln{a}$$

------------------------

推导一下是如何得到：

$$a^{x} = (e^{\ln{a}x})$$

所以：

$$\frac{\mathrm{d}}{\mathrm{d}x}a^{x} = \frac{\mathrm{d}}{\mathrm{d}x}e^{x\ln{a}}= \ln{a}·e^{x\ln{a}} = a^{x}·\ln{a}$$

还有另一种方法：**对数微分法**

求原本的函数转换成求函数的对数的导数，即$y=e^{x}$，求$z = \ln{y} = x$的导数$\frac{\mathrm{d}z}{\mathrm{d}x}$，再通过隐函数求导还原回来

$$\frac{\mathrm{d}}{\mathrm{d}x}\ln{u} = (\frac{\mathrm{d}}{\mathrm{d}x}\ln{u})\frac{\mathrm{d}u}{\mathrm{d}x}=\frac{1}{u}\frac{\mathrm{d}u}{\mathrm{d}x}$$

当$u=a^{x}$时：

$$\frac{1}{u}\frac{\mathrm{d}}{\mathrm{d}x}u = \frac{\mathrm{d}}{\mathrm{d}x}\ln{u} = \ln{a}$$

所以最终得到：

$$\frac{\mathrm{d}u}{\mathrm{d}x} = a^{x}\ln{a}$$

------------------------

例题1： $v = x^{x}$

两边取对数得：

$$\ln{v} = x\ln{x}$$

两边对$x$取导数：

$$\frac{1}{v}\frac{\mathrm{d}v}{\mathrm{d}x} = \ln{x} + x·\frac{1}{x}$$

所以：

$$\frac{\mathrm{d}v}{\mathrm{d}x} = v(\ln{x}+1) = x^{x}(\ln{x}+1)$$

### 自然常数e

下面推导一下指数函数的导数$\frac{\mathrm{d}}{\mathrm{d}x}a^{x}$

从定义出发：

$$ \lim_{\Delta x\rightarrow 0}{\frac{a^{x+\Delta x} - a^{x}}{\Delta x}} =\lim_{\Delta x\rightarrow 0}{a^{x}\frac{a^{\Delta x} - 1}{\Delta x}} =a^{x}\lim_{\Delta x\rightarrow 0}{\frac{a^{\Delta x} - 1}{\Delta x}} $$

即：

$$\frac{\mathrm{d}}{\mathrm{d}x}a^{x} = a^{x}\lim_{\Delta x\rightarrow 0}\frac{a^{\Delta x}-1}{\Delta x}$$

令：

$$M(a) = \lim_{\Delta x\rightarrow 0}\frac{a^{\Delta x}-1}{\Delta x}$$

则：

$$\frac{\mathrm{d}}{\mathrm{d}x}a = M(a)a^{x}$$

所以现在要求就转变成了$M(a)$

代入$0$可知：

$$\frac{\mathrm{d}}{\mathrm{d}x}a^{x}\bigg|_{x=0} = M(a)a^{0} = M(a)$$

所以，$M(a)$等于指数函数在$x=0$处的斜率

> 所以和之前的现象其实类似，只要知道一个地方的导数，就能进而知道其他地方的导数

所以，我们**定义常数e(自然常数)**，使之满足$M(e) = 1$，即$\frac{\mathrm{d}}{\mathrm{d}x}e^{x}\bigg|_{x=0}=1$

结合之前的$\frac{\mathrm{d}}{\mathrm{d}x}a = M(a)a^{x}$可得：

$$\frac{\mathrm{d}}{\mathrm{d}x}e = M(e)e^{x} = e^{x}$$

> 非常重要的一个式子

----------------------------------------

例：求$\lim_{n\rightarrow \infty}{(1+\frac{1}{n})^{n}}$

两边取对数可得：

$$\ln{((1+\frac{1}{n})^{n})} = n\ln{(1+\frac{1}{n})}$$

记$\Delta x = \frac{1}{n} \rightarrow 0$，所以上式转变为：

$$n\ln{(1+\frac{1}{n})} = \frac{1}{\Delta x}\ln{(1+\Delta x)} = \frac{1}{\Delta x}(\ln{(1+\Delta x)-\ln{(1)}})$$

而这个式子取极限正好是$\ln{x}$在$x=1$处的导数，即$\frac{\mathrm{d}}{\mathrm{d}x}\ln{x}\bigg|_{x=0} = 1$

所以：

$$\lim_{n\rightarrow \infty}{\ln{((1+\frac{1}{n})^{n})}} = 1$$

$$\lim_{n\rightarrow \infty}{(1+\frac{1}{n})^{n}} = e$$

### 对数

引入自然对数$w=\ln{x}$，其定义为：$y=e^{x}\Rightarrow \ln{y} = x$，遵循以下运算法则：

$$\ln{(x_{1}x_{2})} = \ln{x_{1}}+\ln{x_{2}}$$

其中，$\ln{1}=0,\qquad \ln{e}=1$

对数函数的导数是：

$$\frac{\mathrm{d}}{\mathrm{d}x}\ln{x} = \frac{1}{x}$$

---------------------------------------

而对数函数$\frac{\mathrm{d}}{\mathrm{d}x}\ln{x}$的导数需要用到隐函数微分法：

$$w=\ln{x}$$

则有：

$$e^{w} = x$$

对两侧求导：

$$e^{w}\frac{\mathrm{d}w}{\mathrm{d}x} = 1$$

所以得到结果：

$$\frac{\mathrm{d}w}{\mathrm{d}x} = \frac{1}{e^{w}} = \frac{1}{x}$$

## 8. 线性近似

> 接下来的一个章节开始讲导数的应用

线性近似使用一个公式可以概括；

$$f(x) \approx f\left(x_{0}\right)+f^{\prime}\left(x_{0}\right)\left(x-x_{0}\right)$$

他的几何含义是：假设有一个曲线$f(x)$，那么该曲线在切点上近似于其切线。

公式的右边就是其切线的表达

举个例子：

$$f(x) = \ln{x}, \quad \text{导数是}\quad f'(x) = \frac{1}{x}$$

在$x_{0}=1$处：$f(1)=0$，$f'(1) = 1$，所以：

$$f(x)\approx f(1) +f'(1)(x-1) = x-1$$

所以在 $x_{0}=1$处，$f(x)$ 近似于切线，即 $\ln{x} \approx x-1$，作图如下：

![图片10.png](https://i.loli.net/2021/07/15/ycbVk1hdfI5On2K.png)

---------------------------

下面从导数的定义来解释这个线性近似：

导数的定义是：

$$f^{\prime}\left(x_{0}\right)=\lim _{x \rightarrow x_{0}} \frac{\Delta f(x)}{\Delta x}$$

逆向看待就是：

$$\lim_{x \rightarrow x_{0}} \frac{\Delta f(x)}{\Delta x} = f^{\prime}\left(x_{0}\right)$$

当$\Delta x\rightarrow 0$时，$\frac{\Delta f(x)}{\Delta x} \approx f^{\prime}\left(x_{0}\right)$

所以有：

$$\Delta f(x) \approx f^{\prime}\left(x_{0}\right) \Delta x$$

$$f(x)-f\left(x_{0}\right) \approx f^{\prime}\left(x_{0}\right)\left(x-x_{0}\right)$$

$$f(x) \approx f\left(x_{0}\right)+f^{\prime}\left(x_{0}\right)\left(x-x_{0}\right)$$

---------------------------

若近似公式以$x_{0}=0$为基点，公式变得更为简单：$f(x)\approx f(0)+f'(0)x$

所以下面讨论一下不同公式在$x_{0}=0$出的近似

|approx|$f'$|$f(0)$|$f'(0)$|
|:--:|:--:|:--:|:--:|
|$\sin{x}\approx x$|$\cos{x}$|$0$|$1$|
|$\cos{x}\approx x$|$-\sin{x}$|$1$|$0$|
|$e^{x}=1+x$|$e^{x}$|$1$|$1$|
|$\ln{(1+x)}\approx x$|$1/(1+x)$|$0$|$1$|
|$(1+x)^{r}$|$r(1+x)^{r-1}$|$1$|$r$|

举几个类似的例子：

1. 求$\ln{1.1}$的时候，就可以应用$\ln{1.1} = \ln{(1+0.1)} = 0.1$

2. 求$\frac{e^{-3 x}}{\sqrt{1+x}}$在$x_{0}=0$处的近似

    $$\frac{e^{-3 x}}{\sqrt{1+x}}=e^{-3 x}(1+x)^{-1 / 2} \approx(1-3 x)\left(1-\frac{1}{2} x\right)=1-\frac{7}{2} x+\frac{3}{2} x^{2} \approx 1-\frac{7}{2} x$$

    因为在之前近似切线的时候，已经把很多的二次项全部忽略掉了，所以这里也对二次项急性忽略，就丢掉了

## 9. 曲线构图

### 二次近似

> 和上面的线性近似相同，这里换成使用一个二次函数来近似一点上的函数$f(x)$
>
> 只有在线性近似精度不够的时候才用二阶近似

$$f(x)=f\left(x_{0}\right)+f^{\prime}\left(x_{0}\right)\left(x-x_{0}\right)+\frac{f^{\prime \prime}\left(x_{0}\right)}{2}\left(x-x_{0}\right)^{2}$$

所以上面几个经典公式的二次近似是：

$$\ln(1+x)\approx x-\frac{1}{x}x^{2}$$

$$\sin{x} \approx x$$

$$\cos{x} \approx 1-\frac{1}{2}x^{2}$$

$$e^{x} \approx 1+x+\frac{1}{2}x^{2}$$

$$(1+x)^{r} = 1+rx+\frac{r(r-1)}{2}x^{2}$$

![图片11.png](https://i.loli.net/2021/07/15/7ozTCFBi3bZhLJj.png)

上面表示了$\cos$函数在$x_{0}=0$的线性近似$y=1$和二次近似$y=1-\frac{1}{2}x^{2}$

可以知道，二阶近似的几何意义在于更加接近了原函数（有泰勒展开那味儿了，虽然我感觉这个几何意义像是废话，不过二次比一次应该更能看出函数的趋势）

-----------------------------------------

举个例子：在$x=0$求函数$e^{-3 x} / \sqrt{1+x}$的二阶近似公式

$$e^{-3 x}(1+x)^{-1 / 2} \approx\left[1-3 x+\frac{1}{2}(-3 x)^{2}\right]\left[1+\left(-\frac{1}{2}\right) x+\frac{1}{2}\left(-\frac{1}{2}\right)\left(-\frac{3}{2}\right) x^{2}\right]$$

$$\Rightarrow e^{-3 x}(1+x)^{-1 / 2} \approx 1-3 x-\frac{1}{2} x+\frac{3}{2} x^{2}+\frac{9}{2} x^{2}+\frac{3}{8} x^{2}=1-\frac{7}{2} x+\frac{51}{8} x^{2}$$

> 因为求的是二阶近似，和之前线性近似一样，在对$e^{x}$，$\sqrt{x}$进行二次近似时已经舍去了$O(\Delta x^{3})$项，所以只要是大于二阶的就可以直接不要了

### 曲线构图（凹凸性）

曲线构图：利用一阶导数$f'$和二阶导数$f''$的正负形，得到函数$f$的图像（即图像的凹凸性）

$$ \begin{aligned}  &f^{\prime}(x)>0 \Rightarrow f(x) \text{递增}\\\\\\\\  &f^{\prime}(x)<0 \Rightarrow f(x) \text{递减}\\\\\\\\  &f^{\prime\prime}(x)>0 \Rightarrow f^{\prime}(x) \text{递增} \Rightarrow f(x) \text{为凸函数}\\\\\\\\  &f^{\prime\prime}(x)<0 \Rightarrow f^{\prime}(x) \text{递减} \Rightarrow f(x) \text{为凹函数}\\\\\\\\      \end{aligned} $$

举个例子；$f(x) = 3x-x^{2}$

可得一阶导数：$f'(x) = 3-3x^{2} = 3(1-x)(1+x)$

所以：

$-1<x<1$时，$f'(x)>0$，所以$f(x)$递增

$-1>x \text{或} x>1$时，$f'(x)<0$，所以$f(x)$递减

> **驻点：** 当$f'(x_{0})=0$时，则称$x_{0}$为函数$f(x)$的驻点，$y_{0} = f(x_{0})$为函数的驻点值。本函数中，驻点为1,-1；驻点值为：$f(1)=2$，$f(-1)=-2$

所以通过一阶导数，我们可以大致勾勒出这个函数的大致趋势：

![图片12.png](https://i.loli.net/2021/07/16/lzuHQqGaih1XMSj.png)

其二阶导数：$f''(x) = -6x$

$x>0$时，$f''(x)<0$，函数为凹函数
$x<0$时，$f''(x)>0$，函数为凸函数

所以函数的图像就可以大致画出来了： 

![图片15.png](https://i.loli.net/2021/07/16/JNGiwZeKdpBjnSF.png)

> **拐点：** $f''(0)=0$所在的点，在这里函数的凹凸性改变


再举个例子，双曲线：$f(x) = \frac{x+1}{x+2}$

他的一阶导数是:

$$f'(x) = \frac{1}{(x+2)^{2}} > 0 $$

所以他的图像没有驻点，这个函数是恒增的

这个时候画图，还是找关键点，比如这个里面存在断点：$x=2$，分别区域在$x=-2$的左右极限：

$$f\left((-2)^{+}\right)=\frac{-2+1}{(-2)^{\downarrow}+2}=-\frac{1}{0^{+}}=-\infty$$

$$f\left((-2)^{-}\right)=\frac{-2+1}{(-2)^{-}+2}=-\frac{1}{0^{-}}=+\infty$$

接下来讨论函数两侧边界的状态：$x\rightarrow \pm \infty$

$$f(x)=\frac{x+1}{x+2}=\frac{1+1 / x}{1+2 / x} \rightarrow 1$$

所以，最后可以对这个函数进行画图：

![图片16.png](https://i.loli.net/2021/07/16/W5mlRzLa3iZ41AG.png)

函数的**递增区间**是 $-\infty < x < -2$ 并 $-2<x<\infty$，并不能说函数的递增区间是负无穷到正无穷

-----------------------------------------

**总结一下上面的作图步骤：**

1. **描点。** a）标记函数的不连续点，特别是函数值趋向于无穷的点；b）边界点，例如无穷远处；c）容易求取的函数点
2. **求驻点。** 求出驻点和其函数值，$f'(x) =0 $
3. **判断一阶正负性。** 判断一阶导数在每个驻点或者不连续点为端点的区间内的正负性，即函数的增减。
4. **判断二阶正负性。** 判断二阶导数的正负性，判断函数的凹凸性，求出$f''=0$的拐点
5. 整合以上信息

举个例子：$f(x) = x/\ln{x}$，其中$x>0$

第一步，找各种关键点

首先考虑他的奇点，即不连续点$\ln{x} = 0$时：

$$f\left(1^{+}\right)=\frac{1}{\ln 1^{+}}=\frac{1}{0^{+}}=+\infty$$

$$f\left(1^{-}\right)=-\infty$$

接下来考虑这个函数的末端，因为限制了定义域$x>0$，所以考虑$x=0^{+}$和$x\rightarrow \infty$

$$f\left(0^{+}\right)=\frac{0^{+}}{\ln 0^{+}}=\frac{0^{+}}{-\infty}=0$$

$$f\left(10^{10}\right)=\frac{10^{10}}{\ln 10^{10}}=\frac{10^{10}}{10 \ln 10} \gg 1 \rightarrow \infty$$

> 这里是把$x\rightarrow \infty$代入了一个非常大的数值来看

第二步，判断每个区间的增减性

这个函数的一阶导数是：

$$f^{\prime}(x)=\frac{\ln x-x(1 / x)}{(\ln x)^{2}}=\frac{(\ln x)-1}{(\ln x)^{2}}$$

找到了函数的驻点：$f'(x)=0$时，$x=e$

$0<x<1$时，$f(x)$递减
$1<x<e$时，$f(x)$递减
$e<$时，$f(x)$递增

第三步，求二阶导数判断函数的凹凸性

$$f^{\prime \prime}(x)=-(\ln x)^{-2} \frac{1}{x}+2(\ln x)^{-3} \frac{1}{x}=\frac{2-\ln x}{x(\ln x)^{3}}$$

$0<x<1$，函数为凹
$1<x<e^{2}$，函数为凹
$e<x$，函数为凹


所以可以做出图像：

![图片17.png](https://i.loli.net/2021/07/16/uxBbprisQdOmEoz.png)


## 12.最值问题

> 这个课程因为进度问题所有标号都乱掉了...

在图像上可以很容易找到最大值和最小值，最关键的还是上面的曲线构图

举些例子：

1) 一条长度为1的绳子，裁成两段，分别围城两个正方形，求面积之和的最大值。

面积之和可以表达为：$f(x) = (\frac{x}{4})^{2} + (\frac{1-x}{4})^{2}$

因为求面积之和的最大，所以取导数满足：$f'(x) = \frac{x}{8} - \frac{1-x}{8} =0$

得到$x=\frac{1}{2}$，可以得到驻点值：$f(\frac{1}{2})=\frac{1}{32}$ (但是这个情况不知道是最大值或者是最小值，这里得到的就是最小值)

检查边界值：

$A(0^{+}) = \frac{1}{16}$

$A(1^{-}) = \frac{1}{16}$

> **所以画图是非常非常重要的手段**

2) 固定容积$V=x^{2}y$没有盖子的盒子，求其表面积$A=x^{2}+4xy$的最小值

这里主要介绍一下用隐函数求导法来对这个问题进行求导（其实也联系到了相关变化率）

体积公式两边对$x$进行求导：

$$\frac{\mathrm{d}}{\mathrm{d}x}(V=x^{2}y) \Rightarrow 2xy + x^{2}y' =0 \Rightarrow y' = -\frac{2y}{x}$$

把$y$看做是$x$的函数，因此上面的式子就是$y'$必须满足的条件

下面对表面积公式进行求导：

$$\frac{d}{d x} A=2 x+4 y+4 x y^{\prime}=2 x+4 y+4 x\left(\frac{2 y}{-x}\right)=2 x-4 y=0$$

得到$x=2y$时为驻点

求他的二阶导数进行检验一下：

$$\frac{\mathrm{d}^{2}}{\mathrm{d}x^{2}}A = 2+4(\frac{2y}{x})>0$$

## 13. 牛顿迭代法

> 目的其实是为了得到数值解

**牛顿迭代法**：从一个任意点$x_{0}$出发（最好是相似的），做这个点上函数的切线，和$X$轴相交于一点$x_{1}$，重复这个过程，得到近似的数值解。

切线表达式为：$y-y_{0} = m(x-x_{0})$

切线与$X$轴的交点为：$x_{1} = x_{0} - \frac{f(x_{0})}{f'(x_{0})}$

整理一下，**牛顿迭代法的通项公式**为：

$$x_{n+1} = x_{n} - \frac{f(x_{n})}{f'(x_{n})}$$

-----------------------------

举个例子：解方程$x^{2}=5$，相当于求$f(x) = x^{2}-5=0$的解

首先取近似点：$x_{0}=2$，函数的一阶导数是：$f'(x) = 2x$

所以可以得到：

$$ \begin{aligned} &x_{1}=\frac{1}{2} \cdot 2+\frac{5}{4}=\frac{9}{4} \\\\\\\\ &x_{2}=\frac{1}{2} \cdot \frac{9}{4}+\frac{5}{2} \cdot \frac{4}{9}=\frac{161}{72} \\\\\\\\ &\cdots \end{aligned} $$

![图片18.png](https://i.loli.net/2021/07/16/XB3UxWqNIVjLge1.png)
> 图源：知乎@三少爷的键

> 其中的误差分析没太听懂

牛顿迭代法要求一阶导数绝对值$|f'|$不能太小；二阶导数绝对值$|f''|$不能太大，初值$x_{0}$不能离太远

- 如果一阶导数太小，一阶导数在分母位置：$x_{1} = x_{0} - \frac{f(x_{0})}{f'(x_{0})}$，计算结果会发生很大偏离，极端情况一阶导数为0，切线不再与$X$轴相交
- 或者就在两个数值之间循环，收敛不到一个固定的值

![图片19.png](https://i.loli.net/2021/07/17/R2OJ1PvwYc6WN4G.png)
> 图源：知乎@三少爷的键

## 14. 中值定理与重要不等式

### 中值定理

![图片20.png](https://i.loli.net/2021/07/17/IPn8KTY29QWEojx.png)

**中值定理 (Mean Value Theorem, MVT)：** 如果函数$f$在区间$(a,b)$之间可谓且连续，则有：

$$\frac{f(b)-f(a)}{b-a} = f'(c)$$

其中，$a<c<b$。

**中值定理的几个推论：**

1. $f'(x)>0$，则$f(x)$递增
2. $f'(x)<0$，则$f(x)$递减
3. $f'(x)=0$，则$f(x)$为常函数

</br>

4. $f'(x)>0$，则$f(b)>f(a)$
4. $f'(x)<0$，则$f(b)<f(a)$
4. $f'(x)=0$，则$f(b)=f(a)$

> 中值定理和线性近似的区别：
> - 线性近似：$\frac{\Delta f}{\Delta x}\approx f'(a)$，即平均值可以近似初始值或最终值，在$a$与$b$距离非常相近时成立。
> - 中值定理：$\frac{\Delta f}{\Delta x}=f'(c)$，$c$位于$a$与$b$之间，即这个平均值小于这一区间上导数的最大值，大于这一区间上导数的最小值
>   $$\min_{a\le x\le b}{f'} \le \frac{\Delta f}{\Delta x}=f'(c) \le \max_{a\le x\le b}{f'}$$

### 重要不等式

1. $$e^{x}>1+x,\quad (x>0)$$
    > 证明：
    > $f(x) = e^{x}- (1+x)$
    > $f(0) = 0; \quad f'(x) = e^{x}-1>0$
    > $f(x)>f(0) \Rightarrow e^{x}>1+x,\quad (x>0))$
    > 证毕

2. $$e^{x}>1+x+\frac{x^{2}}{2}+\frac{x^{3}}{3 \times 2}+\frac{x^{4}}{4 \times 3} \ldots \ldots$$


## 15. 无穷小量与不定积分

### 微分

**微分：** 存在函数$y=f(x)$，$y$的微分记作$\mathrm{d}y$，他的定义是：$\mathrm{d}y = f'(x)\mathrm{d}x$，也可以称作是$f$的微分。

> 因此导数就是记作两个无穷小量的比。

> $\Delta x$和$\mathrm{d}x$其实还是有区别的
> ![图片21.png](https://i.loli.net/2021/07/17/8miy9GxMfnYs3Eq.png)
> 图源：知乎@三少爷的键

### 不定积分

**不定积分：** 用一个新函数：$G(x) = \int{g(x)}\mathrm{d}x$为$g(x)$的**反导数**，其中符号$\int$为积分符号。$G(x)$满足$G'(x)=g(x)$

-------------------------

下面是常见函数的一些不定积分：

1. $$\int \sin x d x=-\cos x+c$$

</br>

2. $$\int x^{a} d x=\frac{1}{a+1} x^{a+1}+c, \quad a \neq-1$$

</br>


3. $$\int \frac{d x}{x}=\ln |x|+c$$

    其中，$x<0$的情况也符合。

    这个可以和上面的2.一起记，因为他是被2.排除掉的$a=-1$的情况

</br>

4. $$\int \sec ^{2} x d x=\tan x+c$$

</br>

5. $$\int \frac{d x}{\sqrt{1-x^{2}}}=\arcsin x+c $$

</br>


6. $$\int \frac{1}{1+x^{2}} d x=\arctan x+c$$

-------------------------

**积分的唯一性**：如果两函数的导师相等，$F'=G'$，则有$F(x) = G(x) +c$。

> 也就是所有与求得积分相差一个常数的函数也都是积分

-------------------------

> 事实上有时候积分很难，根本求不出来，接下来的课程会慢慢交一些积分的方法，这里先是换元法

举例子时间：

1. $$\int{x^{3}(x^{4}+2)^{5}}\mathrm{d}x$$

    应用**换元法(变量代换)**：

    令$u=x^{4}+2$，则有$\mathrm{d}u = 4x^{3}\mathrm{d}x$，所以有：

    $$\int{x^{3}(x^{4}+2)^{5}} = \int{u^{5}\frac{1}{4}\mathrm{d}u} = \frac{1}{24}u^{6}+c = \frac{1}{24}(x^{4}+2)^{6}+c$$

    > 这里的话，需要注意一下第一步的代换：$x^{3}\mathrm{d}x = \frac{1}{4}\mathrm{d}u$；$x^{4}+2 = u$，所以有第一步

</br>

2. $$\int \frac{x d x}{\sqrt{1+x^{2}}}$$

    > 这个其实直观就能看出来，因为看到了$-1/2$次幂这个东西，所以可以猜想一下积分函数应该是一个$1/2$次幂这个东西，所以尝试一下$\frac{\mathrm{d}}{\mathrm{d}x}(1+x^{2})^{\frac{1}{2}}=\frac{x}{\sqrt{1+x^{2}}}$，和所求一致

    采用换元法：

    令 $u=1+x^{2}$, 则有 $d u=2 x d x$ 

    $$\int \frac{x d x}{\sqrt{1+x^{2}}}=\int u^{-1 / 2} \frac{1}{2} d u=u^{1 / 2}+c=\sqrt{1+x^{2}}+c$$

</br>

3. $$\int e^{6 x} d x=\frac{1}{6} e^{6 x}+c$$

</br>

4. $$\int x e^{-x^{2}} d x=-\frac{1}{2} e^{-x^{2}}+c$$

</br>

5. $$\int \sin x \cos x d x=\frac{1}{2} \sin ^{2} x+c_{1}=-\frac{1}{2} \cos ^{2} x+c_{2}$$
   
   > 这个积分有两个不同的答案，但得到的导数都是一样的，所以是同一族的。而其中的系数$c_{1}$和$c_{2}$需要满足：$c_{1}-c_{2} = -\frac{1}{2}$

</br>

6. $$\int \frac{1}{x \ln x} d x=\ln (|\ln x|)+c$$


## 15. 微分方程和分离变量

> MIT 18.03是完整的微分方程的课，这里只是个引子

最简单的微分方程：$\frac{\mathrm{d}y}{\mathrm{d}x} = f(x)$
他的解为：$y=\int{f(x)\mathrm{d}x}$

------------------------------

**分离变量法：** 若微分方程可以写成: $\frac{\mathcal{d}y}{\mathcal{d}x}=f(x)g(y)$的形式，则经过分离变量有：

$$\frac{\mathcal{d}y}{g(y)} = f(x)\mathrm{d}x$$

通过$H(y) = \int{\frac{1}{g(y)}\mathrm{d}y}$ 和 $F(x) = \int{f(x)\mathrm{d}x}$，则有：

$$H(y) = F(x) +c$$

可求得微分方程的显式解为：

$$y=H^{-1}(F(x)+c)$$

继续举例子：

1. $$(\frac{\mathrm{d}}{\mathcal{d}x}+x)y=0$$

    > $(\frac{\mathrm{d}}{\mathcal{d}x}+x)$在量子力学中成为湮灭算符，谐振子的基态由这个方程决定

    $$\frac{d y}{d x}=-x y \Leftrightarrow \frac{d y}{y}=-x d x \Leftrightarrow \int \frac{d y}{y}=\int-x d x$$

    > 这个方程和之前讲过的区别是，这个不仅仅是关于$x$的表达式，还融合了$y$，所以需要进行**分离变量**，把$y$和$x$分别移到方程的左右两边

    通过以上得到：

    $$\ln{|y|} = -\frac{x^{2}}{2}+c$$

    最后得到结果：

    $$y=\pm Ae^{-x^{2}/2}, \text{其中：} A=e^{c}$$

    > 这个函数本质就是正态分布，因此常出现在量子力学中，表达粒子的位置

    **注意：**
    
    1. 求不定积分的过程中很容易忽略取值的正负
    2. 求不定积分时，有可能会因为除以一个变量而漏掉0解，比如上面因为同除了$y$，所以会漏掉了$y=0$时的解


2. 曲线上点的切线斜率是该点和原点连线斜率的两倍，求曲线表达式
    
    列出微分方程：$\frac{\mathrm{d}y}{\mathrm{d}x} = 2\frac{y}{x}$

    分离变量得：$\int{\frac{\mathrm{d}y}{y}}=\int{\frac{2}{x}\mathrm{d}x}$

    所以有： $\ln{|y|} = 2\ln{|x|} +c$

    最后得到：$y=ax^{2}$，是从原点得到的抛物线

</br>

**本单元的核心内容就是通过一阶导数和二阶导数的信息，获取函数本身的信息。**

## 16. 定积分

> 主要来讨论定积分的定义

### 曲线下的面积

![图片22.png](https://i.loli.net/2021/07/18/rn92JYPTbXFcpow.png)

定积分：在几何法的描述下，表达为曲线下的面积，记为：

$$S = \int_{a}^{b}{f(x)\mathrm{d}x}$$

> 他和不定积分的区别在于：定积分指明了起点$a$和终点$b$

**计算曲线下面积的方法：**

1. 将曲线下的面积划分为一小段的“矩形”
2. 将矩形的面积相加
3. 对矩形去极限，宽度变为无限小

</br>

**举个例子；**

![图片23.png](https://i.loli.net/2021/07/18/KjzsWldIXemr8L5.png)

$$f(x) = x^{2}, \quad a=0,\quad b\text{任意}$$

所以按照上图的划分对曲线下面积求和：

|$x$|对应矩形的高$f(x)$|
|:--:|:--:|
|$b/n$|$(b/n)^{2}$|
|$2b/n$|$(2b/n)^{2}$|
|$3b/n$|$(3b/n)^{2}$|
|$\cdots$|$\cdots$|

所以，曲线下的面积：

$$ \begin{aligned} S  &= \frac{b}{n}(\frac{b}{n})^{2}+\frac{b}{n}(\frac{2b}{n}) {2}+\cdots+\frac{b}{n}(\frac{nb}{n})^{2} \\\\\\\\ & = (\frac{b}{n})^{3}(1^{2}+2^{2}+3^{2}+\cdots+n^{2}) \\\\\\\\ & = b^{3}(\frac{1^{2}+2^{2}+\cdots+n^{2}}{n^{3}}) \\\\\\\\ & = \frac{1}{3}b^{3} \end{aligned} $$

> 这里对于 $1^{2}+2^{2}+\cdots+n^{2}$ 的几何求解也很有意思：
> ![图片25.png](https://i.loli.net/2021/07/18/d9j5OyrB1UaCn2P.png)
> 每一个$n^{2}$都可以想象成一个高为1的长方块然后堆叠起来求体积，然后在求的时候可以把这个金字塔换一个视角，在矢状面看(右图)：
> 金字塔的面积小于外接椎体的体积（红框）：$\frac{1}{3}(n+1)^{3}$
> 金字塔的面积大于内接椎体的体积（绿框）: $\frac{1}{3}n^{3}$
> 所以有：
> $$\frac{1}{3}<\frac{1^{2}+2^{2}+\cdots+n^{2}}{n^{3}}<\frac{1}{3}\left(1+\frac{1}{n}\right)^{3} \underset{n \rightarrow \infty}{\longrightarrow} \frac{1}{3}$$

### 累积和解释

定积分的一般步骤：

1. 将$(a,b)$区间划分为$n$个小区间，则每一个小区间的差分为：$\Delta x = \frac{b-a}{n}$

2. 在每个小区间上取任意的函数值$f(c_{i})$作为高度值，与底$\Delta x$相乘并相加，得到：
    $$\sum_{i=1}^{n} f\left(c_{i}\right) \Delta x \underset{\Delta x \rightarrow 0}{\longrightarrow} \int_{a}^{b} f(x) d x$$

    该公式即为**黎曼和**

## 17. 微积分第一定理

### 微积分第一定理

**微积分第一定理**(Fundamental Theorem of Calculus, FTC1)：

若$F'(x) = f(x)$，则有$\int_{a}^{b}{f(x)\mathrm{d}x} = F(b)-F(a)$

引入符号：$F(x)\big|_{a}^{b} = F(b)-F(a)$，简化上述公式为：

$$\int_{a}^{b}{f(x)\mathrm{d}x} = F(x)\big|_{a}^{b}$$


-------------------------------

举例子：

1. 上面做过的函数：$F(x) = \frac{x^{3}}{3}$

    $\int_{a}^{b}{x^{2}\mathrm{d}x} = \frac{b^{3}}{3}-\frac{a^{3}}{3}$

2. 求曲线$f(x) = \sin{x}$一个波峰之下的面积：

    $\int_{0}^{\pi}{\sin{x}\mathrm{d}x} = (-\cos{x})\big|^{\pi}_{0}=-\cos{\pi} - (-\cos{0}) = 2$

3. $$\int_{0}^{2 \pi} \sin x d x=\left.(-\cos x)\right|_{0} ^{2 \pi}=-\cos 2 \pi-(-\cos 0)=0$$

    > 积分中的几何解释是要推广到$f$是负的情况下，即$X$轴一下，这个时候的积分几何解释为$X$轴上的面积减去$X$轴一下的面积

### 定积分性质

1. $$\int_{a}^{b}(f(x)+g(x)) \mathrm{d} x=\int_{a}^{b} f(x) \mathrm{d} x+\int_{a}^{b} g(x) \mathrm{d} x$$

</br>

2. $$\int_{a}^{b} c f(x) \mathrm{d} x=c \int_{a}^{b} f(x) \mathrm{d} x$$

</br>

3. $$\int_{a}^{c} f(x) \mathrm{d} x=\int_{a}^{b} f(x) \mathrm{d} x+\int_{b}^{c} f(x) \mathrm{d} x$$

</br>

4. $$\int_{a}^{a} f(x) \mathrm{d} x=0 $$

</br>

5. $$\int_{a}^{b} f(x) \mathrm{d} x=-\int_{b}^{a} f(x) \mathrm{d} x$$

### 换元法

$$\int_{u_{1}}^{u_{2}} g(u) d u=\int_{x_{1}}^{x_{2}} g(u(x)) u^{\prime}(x) d x$$

> 注意，$u'(x)$的符号不能发生改变

其中，$u=u(x)$，$\mathrm{d}u = u'(x)\mathrm{d}x$ 且 $u_{1} = u(x_{1})$，$u_{2} = u(x_{2})$

> 特别注意，换元之后，积分的上下限也随之改变

**举个例子：**

$$\int_{1}^{2}\left(x^{3}+2\right)^{5} x^{2} d x \Leftrightarrow \int_{3}^{10} u^{5} \frac{1}{3} d u=\left.\frac{1}{18} u^{6}\right|_{3} ^{10}$$

再举一个符号发生改变时导致错误的例子：

$$\int_{-1}^{1} x^{2} \mathrm{d} x \quad != \int_{1}^{1} u \frac{1}{2 \sqrt{u}} \mathrm{d} u=0$$

这里用$u=x^{2}$，$u'(x) = 2x$，而这里$x$为负时，$u'(x)<0$，$x$为正时，$u'(x)>0$，导致：

$$x=\frac{1}{2 x} \mathrm{d} u \quad != \frac{1}{2 \sqrt{u}} \mathrm{d} u$$

因为这里的 $x = \pm \sqrt{u}$

所以正确的做法应该是：当遇到$u'(x)$符号改变时分段做

------------------------------

**微积分第一定理和中值定理的比较：**

对于$\Delta F = F(b) - F(a)$，$\Delta x = b-a$

- 微积分第一定理的表述为：

    $$\Delta F =\text{Ave}(F')\Delta x$$

    > $$\Delta F = \int_{a}^{b}{f(x)\mathrm{d}x} \Rightarrow \frac{\Delta F}{\Delta x} = \frac{1}{b-a}\int_{a}^{b}{f(x)\mathrm{d}x}$$
    > 即：$\Delta F$可以表达为$f(x)$的均值乘以这一间隔

- 而中值定理的表述为：

    $$\Delta F = F'(c)\Delta x$$

    > 这里的$F'(c)$在定义域内是不确定的，可以确定的只是：
    > $$\min{F'(x)\Delta x}\le \Delta F = F'(c) \Delta x\le \max{F'(x)\Delta x}$$
    > 即，中值定理给出的是含糊的状态，不提倡使用中值定理指导计算


## 18. 微积分第二定理

> 这里的主旨是用导数$f$去理解原函数$F(x)$

**微积分第二定理：** 已知一个连续函数$f(x)$，定义新函数：$G(x)=\int_{a}^{x}{f(t)\mathrm{d}t}$，其中$a\le t \le$，则$G(x)$满足$G'(x) = f(x)$

从微分角度看，$G(x)$是$\begin{cases}    & y' = f \\\\    & y(a) = 0\end{cases}$的解

> 因为 $y(a) = G(a) = \int_{a}^{a}{f(t)\mathrm{d}t} = 0$

或者可以理解成：

$$\frac{\mathcal{d}}{\mathcal{d}x}\int_{a}^{x}{f(t)\mathrm{d}t} = f(x)$$

**举个例子：**

求：$$\frac{d}{d x} \int_{1}^{x} \frac{d t}{t^{2}}$$

这个其实一眼就能看出来是$\frac{1}{x^{2}}$，因为后面的积分部分：$\int_{1}^{x} \frac{d t}{t^{2}}$就是上面微积分定理中的$G(x)$，所以看似很复杂，但其实就是积分再微分

----------------------------

下面简要证明一下微积分第二定理：

![图片26.png](https://i.loli.net/2021/07/19/HtUWMZ5ksg8Ez4V.png)

微积分第二定理用画图特别容易懂

$G(x)$表示的现有的$f(x)$在$(a,x)$区间中的曲线面积，现在再往前推荐一小段区间$\Delta x\rightarrow 0$，曲线下新增的面积为$\Delta G(x)$

所以有：$\Delta G(x)\approx \Delta x f(x)$

$$\lim_{\Delta x\rightarrow 0}{\frac{\Delta G(x)}{\Delta x}}=f(x)$$

思路是好的，但是我jio得过程有点牵强，特别是约等于那里，我会这么证：

$$\Delta G(x) = G(x+\Delta x) - G(x) = \int_{a}^{x+\Delta x}{f(t)\mathrm{d}t} - \int_{a}^{x}{f(t)\mathrm{d}t} = \int_{x}^{x+\Delta x}{f(t)\mathrm{d}t} $$

$$\lim_{\Delta x\rightarrow 0}{\frac{\Delta G(x)}{\Delta x}}=\frac{1}{\Delta x}\int_{x}^{x+\Delta x}{f(t)\mathrm{d}t} = f(x)$$

----------------------------

有了微积分第二定理，我们可以定义一些没有显式表达的函数，即超越函数，如：

$y'=e^{-x^{2}},\quad y(0)=0$

可以得到原函数：

$$F(x) = \int_{0}^{x}{e^{-t^{2}}\mathrm{d}t}$$

这里的$F(x)$不能用任何已知的函数来显式的表示，是一个超越函数

> 对数函数同样也是超越函数，只有在微积分里会得到这些函数。

## 19. 定积分在对数及几何应用

### 微积分定理的应用

> 接着上面讲第二定理的应用：用导数来表述原函数

给出了函数导数：$y'(x) = \frac{1}{x}$，描述这个函数

就可以通过第二定理对这个函数进行描述(而不用求出具体的函数形式)，原函数为：

$$L(x) = \int_{1}^{x}{\frac{1}{t}\mathrm{d}t}$$

他的导数：$L'(x)=\frac{1}{x}$；$L(1) = \int_{1}^{1}{\frac{1}{t}\mathrm{d}t} =0 $

继续得到二阶导数；

$$L''(x) = -\frac{1}{x^{2}}$$

所以就可以对这个函数进行画图了：

![图片27.png](https://i.loli.net/2021/07/19/T4S3PUlCck2F7st.png)
> 图源：知乎@三少爷的键

> 这里可以接着证明一下：对于$L(x) = \int_{1}^{x}{\frac{1}{t}\mathrm{d}t}$，满足：$L(ab)=L(a)+L(b)$
> 感觉对积分的还原还不是很熟练，所以再训练一下
> 
> $$L(ab) - L(a) = \int_{a}^{ab}{\frac{1}{t}\mathrm{d}t}$$
> 
> 令$u=\frac{t}{a}$ (目的是消去积分中的$a$),所以上面的式子变成了：
> 
> $$L(ab) - L(a) = \int_{1}^{b}{\frac{a}{ua}\mathrm{d}u} =  \int_{1}^{b}{\frac{\mathrm{d}u}{u}} = L(b)$$
> 
> > 这里的技巧$u=\frac{t}{a}$，主要体现在想要积分上下所有的数值减少$a$倍，所以新的变量是原变量的$\frac{1}{a}$倍

-----------------------------

还有一些其他用积分表示的函数：

菲涅尔积分：

$$C(x)=\int_{0}^{x} \cos \left(t^{2}\right) \mathrm{d} t, \quad S(x)=\int_{0}^{x} \sin \left(t^{2}\right) \mathrm{d} t$$

傅里叶分析中的：

$$H(x)=\int_{0}^{x} \frac{\sin t}{t} \mathrm{d} t$$

黎曼假设；

$$L i(x)=\int_{2}^{x} \frac{\mathrm{d} t}{\ln t}$$

> 这个约等于小于$x$的质数的个数

### 求两条曲线之间的面积

![图片28.png](https://i.loli.net/2021/07/19/tkxhdzelmBi5O2y.png)
>图源：知乎@三少爷的键

使用黎曼和的思路来计算面积，每个小区间的宽度为$\mathrm{d}x$，高度为：$f(x)-g(x)$。所有小块相加得到两条曲线之间的面积：

$$\int_{a}^{b}{(f(x)-g(x))\mathrm{d}x}=\text{面积}$$

> 面对问题，重要的解决步骤：
> 1. 首先要确定被积函数
> 2. 确定取极限的基本信息，积分上下限
> 3. 最后才是计算积分

举个例子：

求$x=y^{2}$和$y=x-2$之间的面积

![图片29.png](https://i.loli.net/2021/07/19/Ka87BfQkCi2O4lF.png)

**第一种办法：**

曲线包围的面积实际上是由左右两边组成的：左边的只是抛物线所围成；右边的则是抛物线和直线围成

所以首先确定重要的坐标点，即抛物线与直线的交点：$(1,-1)$和$(4,2)$

所以面积就是：

$$S=\int_{0}^{1}{(\sqrt{x}-(-\sqrt{x}))\mathrm{d}x}+\int_{1}^{4}{(\sqrt{x}-(x-2))\mathrm{d}x}$$

**第二种办法；**

从$y$的方向上进行积分，因此面积是：

$$S = \int_{-1}^{2}{((y+x)-y^{2})\mathrm{d}y}$$

## 20. 求体积

### 圆盘法

**旋转立方体问题：**

$XY$平面山的一段曲线$y=f(x)$，沿着$X$轴形成三维旋转体，求其体积

![图片30.png](https://i.loli.net/2021/07/19/pOEUNYmzu37FTtP.png)

取“一层”切片，切片为一个圆盘状，厚度为$\mathrm{d}x$，表面积为圆，所以这一层的体积为：

$$\mathrm{d}V=(\pi y^{2})\mathrm{d}x$$

**举个例子：**

求半径为$a$的球体的体积：

首先要求得$y$对$x$的公式：$$x^{2}+y^{2} = a^{2}$$

所以：$$y^{2} = a^{2}-x^{2}$$

代入球体体积公式：

$$V = \int_{-a}^{a}\pi (a^{2}-x^{2})\mathrm{d}x = \pi(a^{2}x - \frac{1}{3}x^{3})\big|_{-a}^{a} = \pi \frac{4}{3} a^{3}$$

### 壳层法


![图片31.png](https://i.loli.net/2021/07/19/mwFt6CzePIHfxpW.png)

曲线$y=f(x)$绕着$X$轴旋转形成三维旋转体，求这个坩埚的体积。本例中：$y=x^{2}$

这个时候取切片和上面的不同，这个时候是在$X$上取一小段$\Delta x$，然后把这一小段所在的片段看成一根竖棒，旋转一圈，得到的长方形面积所谓体积的一部分，这样逐层靠里。这个长方形的长就是绕一圈的圆周长，宽就是这个函数和上顶部围成的高，即：

$$\mathrm{d}V=2\pi x(a-y)\mathrm{d}x$$

$$V=\int_{0}^{\sqrt{a}} 2 \pi\left(a x-x^{3}\right) d x=\left.2 \pi\left(\frac{a x^{2}}{2}-\frac{x^{4}}{4}\right)\right|_{0} ^{\sqrt{a}}=\frac{\pi a^{2}}{2}$$

## 21. 功、平均值、概率

### 平均值

![图片22.png](https://i.loli.net/2021/07/18/rn92JYPTbXFcpow.png)

取一串数字的平均，等价于黎曼和的形式。取极限则趋向于一个积分式，称之为连续平均：

$$\frac{y_{1}+y_{2}+\cdots+y_{n}}{n} \rightarrow \frac{1}{b-a}\int_{a}^{b}{f(x)\mathrm{d}x}$$

**举个例子**：求半圆的平均高度

![图片32.png](https://i.loli.net/2021/07/19/Di3zgf6Oyt7hoj5.png)

可以得到半圆公式：$y=\sqrt{1-x^{2}}$

所以，计算得到半圆的平均高度就是：

$$\frac{1}{b-a} \int_{a}^{b} f(x) d x=\frac{1}{1-(-1)} \int_{-1}^{1} \sqrt{1-x^{2}} d x=\frac{\pi}{4}$$

-------------------------

**加权平均：**

$$\frac{\int_{a}^{b} f(x) w(x) d x}{\int_{a}^{b} w(x) d x}$$

**举个例子：** 煮沸上一讲中坩埚中的水，坩埚高1m，锅口的直径为2m，锅界面的轮廓线满足方程：$y=x^{2}$。水温随着坩埚深度连续变化，底层100°，顶层为70°，求所需的加热能量。

![图片33.png](https://i.loli.net/2021/07/19/EbArinHeUXPvW7J.png)

温度沿着$Y$轴线性变化，各水平面上温度都是常数。将每一层所需能量相加得到了所需的能量。所以能力累积公式为：

$$\begin{aligned} \int_{0}^{1} T\left(\pi x^{2}\right) \mathrm{d} y &=\int_{0}^{1}(100-30 y)\left(\pi x^{2}\right) \mathrm{d} y \\\\\\\\ &=\int_{0}^{1}\left(100 \pi y-30 y^{2}\right) \mathrm{d} y \\\\\\\\ &=\left.\left(50 \pi y^{2}-10 \pi y^{3}\right)\right|_{0} ^{1} \\\\\\\\ &=40 \pi \end{aligned}$$

计算坩埚中的平均水温：

$$T=\frac{\int_{0}^{1} T \pi y \mathrm{d} y}{\int_{0}^{1} \pi y \mathrm{d} y}=\frac{40 \pi}{\pi / 2}=80^{\circ} C$$

### 概率

![图片34.png](https://i.loli.net/2021/07/19/anN4XPh5KuDSYm6.png)

随机在区域$0<y<1-x^{2}$内选取一点，那么$x>\frac{1}{2}$的概率是多少？

$$\text{概率} = \frac{\int_{1 / 2}^{1}\left(1-x^{2}\right) \mathrm{d} x}{\int_{-1}^{1}\left(1-x^{2}\right) \mathrm{d} x}=\frac{5}{32}$$

概率通用公式：

$$\text { 概率= } \frac{\int_{x_{1}}^{x_{2}} w(x) \mathrm{d} x}{\int_{a}^{b} w(x) \mathrm{d} x}$$

**举个例子：**

打靶问题：在距离靶心为$r$的无穷小区域$\mathrm{d}A$中，被打中的次数是 $ce^{-r^{2}}\Delta A$。靶子旁边站着一个小孩，求小孩被误伤的概率：

![图片35.png](https://i.loli.net/2021/07/20/JN1oXYtPn6ly5Iz.png)
> 图源：知乎@三少爷的键

首先来看一下这个函数：$e^{-r^{2}}$

![图片36.png](https://i.loli.net/2021/07/20/e9TtONiDsUmj7LQ.png)

对于半径$r_{1}\rightarrow r_{2}$，层厚忽略不计的区域，被打击的次数记为上面图中所示的阴影区域

而计算圆环上，$r_{1}\rightarrow r_{2}$的半径内，被击中的概率实际上就是计算在这个环内被击中的次数占整个平面被击中次数的比。

而该比例，就是$f(x) = e^{-r^{2}}$这个函数图像绕$Y$轴旋转所形成的旋转体中，阴影部分体积所占整个体积的比值

采用层壳法：

$$\int_{r_{1}}^{r_{2}}{(2\pi t)e^{-t^{2}}\mathrm{d}t}=-\pi e^{-t^{2}}\big|_{r_{1}}^{r_{2}}=e^{-r_{1}^{2}}-e^{-r_{2}^{2}}$$

整个区域被击中的次数为：

$$C\pi$$

而半径$r_{1}\rightarrow r_{2}$的区域中，被击中的次数：

$$C(e^{-r_{1}^{2}}-e^{-r_{2}^{2}})$$

所以小孩被误伤的概率；

$$P(r_{1}<r<r_{2}) = \frac{C(e^{-r_{1}^{2}}-e^{-r_{2}^{2}})}{C\pi} = e^{-r_{1}^{2}}-e^{-r_{2}^{2}}$$

如果一个小孩站在3点钟方向到5点钟方向，距离靶心$2a$到$3a$的距离上，则小孩被击中的概率为

$$\left(\frac{5-3}{12}\right) P(2 a \leq r<3 a)=\frac{1}{6}\left(e^{-(2 a)^{2}}-e^{-(3 a)^{2}}\right) \approx \frac{1}{6} \times \frac{1}{16} \approx 1 / 100$$

> 这个例子中的权重因子是：$w(r) = 2\pi cre^{-r^{2}}$
> 表达了实际上靶心被击中的可能性是非常低的，有违之前正太分布的图，反直觉：
> ![图片37.png](https://i.loli.net/2021/07/20/akgIrWLBs5AcqTJ.png)


## 22.数值积分

> 很多积分没有解析解，因此要用数值解法求积分的值。

### 黎曼和

![图片38.png](https://i.loli.net/2021/07/20/UBVwrpQqvst68jX.png)

左边：$\left(y_{0}+y_{1}+\cdots+y_{n-1}\right) \Delta x$
右边：$\left(y_{1}+y_{2}+\cdots+y_{n}\right) \Delta x$

### 梯形法

![图片39.png](https://i.loli.net/2021/07/20/xYUgJdZFr2VuwRI.png)

将所有间断点上的函数值连接，则每个区间上就不再是黎曼和中的矩形，而是梯形，求所有梯形面积有：

$$\left(\frac{y_{0}-y_{1}}{2}+\cdots+\frac{y_{n}-y_{n-1}}{2}\right) \Delta x=\left(\frac{y_{0}}{2}+y_{1}+\cdots+y_{n-1}+\frac{y_{n}}{2}\right) \Delta x$$

可以看到梯形法计算结果等于“左黎曼和”和“右黎曼和”的均值

### 辛普森法

![图片40.png](https://i.loli.net/2021/07/20/SM7wzK38xRmTjWX.png)

辛普森法每个单元要处理一对小分割区域，因此要求n为偶数。

在分割区域上用二次函数抛物线来近似函数曲线。抛物线下的面积等于底乘以平均高度，为$2 \Delta x\left(\frac{y_{0}+4 y_{1}+y_{2}}{6}\right)$

将所有区域相加求和可得：

$$\frac{\Delta x}{3}\left[y_{0}+4 y_{1}+2 y_{2}+4 y_{3}+2 y_{4}+\cdots+2 y_{n-2}+4 y_{n-1}+y_{n}\right]$$

----------------------------

需要说明一下辛普森公式中**抛物线下的面积**是如何得到的：

在 $x_{0}$ ， $x_{1}$ 和 $x_{2}$ 的小区域上用二次多项式 $P(x)=a+b(x-x_{1})+c(x-x_{2})^{2}$ 来拟合函数$y=f(x)$。

二次多项式$P(x)$需要满足：$P(x_{0}) = y_{0}$；$P(x_{1}) = y_{1}$；$P(x_{2}) = y_{2}$。

所以有：

$$ x=\begin{cases} x_{0}, a+b\left(x_{0}-x_{1}\right)+c\left(x_{0}-x_{1}\right)^{2}=y_{0} \\\\\\\\ x_{1}, a=y_{1} \\\\\\\\ x_{2}, a+b\left(x_{2}-x_{1}\right)+c\left(x_{2}-x_{1}\right)^{2}=y_{2} \end{cases} $$

可以得到：

$$c=\frac{y_{0}-2 y_{1}+y_{2}}{2 \Delta x^{2}}, \quad b=\frac{y_{2}-y_{0}}{2 \Delta x}, \quad a=y_{1}$$

用$P(x)$代替$f(x)$进行积分：

$$ \begin{aligned} \int_{x_{0}}^{x_{2}}{f(x)\mathrm{d}x}  &= \int_{x_{0}}^{x_{2}}{[a+b(x-x_{1}+c(x-x_{2})^{2})]\mathrm{d}x} \\\\\\\\ &= 2a\Delta x + \frac{2}{3}c\Delta x^{3} \\\\\\\\ &=\frac{1}{3}(y_{0}+4y_{1}+y_{2})\Delta x \end{aligned} $$
